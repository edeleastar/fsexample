<!DOCTYPE html>
<html>
<head>
  <title>foursquare :: Explore Sample</title>

  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" id="jquery"></script>


  <link href="leaflet/leaflet.css" type="text/css" rel="stylesheet" />
  <link href="styles/apisamples.css" type="text/css" rel="stylesheet" />

  <script src="leaflet/leaflet.js" type="text/javascript"></script>
  <script src="scripts/apisamples.js" type="text/javascript"></script>

  <script src="scripts/jquery.ba-bbq.js" type="text/javascript"></script>

  <script src="scripts/wax.leaf.min.js" type="text/javascript"></script>

  <style type="text/css">
    html { height: 100%; }
    body { height: 100%; margin: 0; padding: 0; }
    /* Give our markers a background image */
    .leaflet-marker-icon {
      background: url(https://foursquare.com/img/pin-blue-transparent.png);
      padding: 6px;
      padding-bottom: 17px;
      top: -6px;
      left: -6px;
    }
  </style>

  <script type="text/javascript">

    var config = {
      apiKey: 'ZNRM2YYMRQDC4T5JJVTJUPIDKED5YSJX3FWDNBFSRXMBWXT2',
      authUrl: 'http://edeleastar.github.io/fsexample',
      apiUrl: 'http://edeleastar.github.io/fsexample'
    };


    function doAuthRedirect() {
      var redirect = window.location.href.replace(window.location.hash, '');
      var url = config.authUrl + 'oauth2/authenticate?response_type=token&client_id=' + config.apiKey +
          '&redirect_uri=' + encodeURIComponent(redirect) +
          '&state=' + encodeURIComponent($.bbq.getState('req') || 'users/self');
      window.location.href = url;
    };
    if ($.bbq.getState('access_token')) {
      // If there is a token in the state, consume it
      var token = $.bbq.getState('access_token');
      $.bbq.pushState({}, 2)
    } else if ($.bbq.getState('error')) {
    } else {
      doAuthRedirect();
    }

    /* HTML 5 geolocation. */
    navigator.geolocation.getCurrentPosition(function(data) {
      var lat = data['coords']['latitude'];
      var lng = data['coords']['longitude'];
      /* Create map. */
      var map = new L.Map('map_canvas')
          .setView(new L.LatLng(lat, lng), 15);
      /**
       * This is a sample map url that you need to change.
       * Sign up at http://mapbox.com/foursquare for a custom map url.
       */
      var mapboxUrl = 'http://a.tiles.mapbox.com/v3/foursquare.map-b7qq4a62.jsonp';
      wax.tilejson(mapboxUrl, function (tilejson) {
        map.addLayer(new wax.leaf.connector(tilejson));
      });
    }
        
    //<![CDATA[
    // Javascript will go here.
    //]]>
  </script>

</head>
<body>
<div style="width: 100%; height: 100%;" id="map_canvas"></div>
</body>
</html>